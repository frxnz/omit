<!doctype html>
<html class="no-js" lang="">

    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Avoiding Gross Javascript with Templates</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="A blog written by Derek Wheelden about front-end web development, CSS, JavaScript, and lots of other things.">
    <link rel="canonical" href="http://omit.io/2013/10/27/avoiding-gross-javascript-with-templates/">

    <style>
        /*# sourceMappingURL=main.css.map */
h1, .post-list a { font-family: "league-gothic", sans-serif; font-weight: normal; }

body { font-family: "ff-tisa-web-pro", serif; font-weight: normal; font-style: normal; }

header h1 { font-family: "ff-tisa-web-pro", serif; font-weight: bold; font-style: normal; }

pre[class*="language-"]:before, h2, h3, h4, h5, h6, .post-list time, article.post .meta { font-family: "source-sans-pro", sans-serif; font-weight: 100; font-style: normal; }

code[class*="language-"], pre[class*="language-"], p > code, footer a { font-family: "fira-mono", monospace; }

/*! normalize.css v3.0.1 | MIT License | git.io/normalize */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* HTML5 display definitions
========================================================================== */
/** Correct `block` display not defined for any HTML5 element in IE 8/9. Correct `block` display not defined for `details` or `summary` in IE 10/11 and Firefox. Correct `block` display not defined for `main` in IE 11. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** 1. Correct `inline-block` display not defined in IE 8/9. 2. Normalize vertical alignment of `progress` in Chrome, Firefox, and Opera. */
audio, canvas, progress, video { display: inline-block; /* 1 */ vertical-align: baseline; /* 2 */ }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9/10. Hide the `template` element in IE 8/9/11, Safari, and Firefox < 22. */
[hidden], template { display: none; }

/* Links
========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* Text-level semantics
========================================================================== */
/** Address styling not present in IE 8/9/10/11, Safari, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari and Chrome. */
dfn { font-style: italic; }

/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* Embedded content
========================================================================== */
/** Remove border when inside `a` element in IE 8/9/10. */
img { border: 0; }

/** Correct overflow not hidden in IE 9/10/11. */
svg:not(:root) { overflow: hidden; }

/* Grouping content
========================================================================== */
/** Address margin not present in IE 8/9 and Safari. */
figure { margin: 1em 40px; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; -webkit-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Contain overflow in all browsers. */
pre { overflow: auto; }

/** Address odd `em`-unit font size rendering in all browsers. */
code, kbd, pre, samp { font-family: monospace, monospace; font-size: 1em; }

/* Forms
========================================================================== */
/** Known limitation: by default, Chrome and Safari on OS X allow very limited styling of `select`, unless a `border` property is set. */
/** 1. Correct color not being inherited. Known issue: affects color of disabled elements. 2. Correct font properties not being inherited. 3. Address margins set differently in Firefox 4+, Safari, and Chrome. */
button, input, optgroup, select, textarea { color: inherit; /* 1 */ font: inherit; /* 2 */ margin: 0; /* 3 */ }

/** Address `overflow` set to `hidden` in IE 8/9/10/11. */
button { overflow: visible; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Firefox, IE 8/9/10/11, and Opera. Correct `select` style inheritance in Firefox. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
input { line-height: normal; }

/** It's recommended that you don't attempt to style these elements. Firefox's implementation doesn't respect box-sizing, padding, or width.  1. Address box sizing set to `content-box` in IE 8/9/10. 2. Remove excess padding in IE 8/9/10. */
input[type="checkbox"], input[type="radio"] { -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** Fix the cursor style for Chrome's increment/decrement buttons. For certain `font-size` values of the `input`, it causes the cursor style of the decrement button to change from `default` to `text`. */
input[type="number"]::-webkit-inner-spin-button, input[type="number"]::-webkit-outer-spin-button { height: auto; }

/** 1. Address `appearance` set to `searchfield` in Safari and Chrome. 2. Address `box-sizing` set to `border-box` in Safari and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari and Chrome on OS X. Safari (but not Chrome) clips the cancel button when the search input has padding (and `textfield` appearance). */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9/10/11. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** Remove default vertical scrollbar in IE 8/9/10/11. */
textarea { overflow: auto; }

/** Don't inherit the `font-weight` (applied by a rule above). NOTE: the default cannot safely be changed in Chrome and Safari on OS X. */
optgroup { font-weight: bold; }

/* Tables
========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

td, th { padding: 0; }

/* http://prismjs.com/download.html?themes=prism-okaidia&languages=markup+css+css-extras+clike+javascript+scss+bash&plugins=autolinker */
/** okaidia theme for JavaScript, CSS and HTML Loosely based on Monokai textmate theme by http://www.monokai.nl/ @author ocodia */
code[class*="language-"], pre[class*="language-"] { position: relative; font-size: 0.9em; line-height: 1.2; color: #f8f8f2; text-shadow: 0 1px rgba(0, 0, 0, 0.3); direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; -moz-tab-size: 4; -o-tab-size: 4; tab-size: 4; -webkit-hyphens: none; -moz-hyphens: none; -ms-hyphens: none; hyphens: none; }

/* Code blocks */
pre[class*="language-"] { padding: 3em 1em 1em; margin: .5em 0; overflow: auto; }
pre[class*="language-"]:before { content: attr(title); display: block; position: absolute; top: 0; left: 0; width: 100%; padding: 0.75em 1em; background: #fd6366; text-shadow: none; text-transform: uppercase; text-align: center; }

:not(pre) > code[class*="language-"], pre[class*="language-"] { background: #272822; }

/* Inline code */
:not(pre) > code[class*="language-"] { padding: .1em; border-radius: .3em; }

.token.comment, .token.prolog, .token.doctype, .token.cdata { color: slategray; }

.token.punctuation { color: #f8f8f2; }

.namespace { opacity: .7; }

.token.property, .token.tag, .token.constant, .token.symbol { color: #f92672; }

.token.boolean, .token.number { color: #ae81ff; }

.token.selector, .token.attr-name, .token.string, .token.builtin { color: #a6e22e; }

.token.operator, .token.entity, .token.url, .language-css .token.string, .style .token.string, .token.variable { color: #f8f8f2; }

.token.atrule, .token.attr-value { color: #e6db74; }

.token.keyword { color: #66d9ef; }

.token.regex, .token.important { color: #fd971f; }

.token.important { font-weight: bold; }

.token.entity { cursor: help; }

.token a { color: inherit; }

*, *:before, *:after { -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; }

html { width: 100%; height: 100%; font-size: 62.5%; }

body { background: white; font-size: 2em; line-height: 1.5; color: #4c3e3e; }

a { text-decoration: none; color: #fd6366; }

header { margin-bottom: 2em; padding: 2em; background: #f8f7f7; text-align: center; }
header h1 { margin: 0; font-size: 5em; text-transform: uppercase; }

.content { width: 90%; max-width: 40em; min-height: 100%; margin: 0 auto -10em; padding-bottom: 20em; }

h1 { font-size: 3em; text-transform: uppercase; }

h2 { font-size: 2em; }

h3 { font-size: 1.5em; color: #fd6366; }

p > code { background: #f8f7f7; font-size: 0.8em; }

.post-list { list-style: none; margin: 0; padding: 0; line-height: 1.2; }
.post-list li { margin-bottom: 2em; }
.post-list a { display: block; font-size: 3em; text-transform: uppercase; color: #4c3e3e; }
.post-list time { color: #cabebf; }

article.post { margin-bottom: 5em; }
article.post h1 { margin: 0; font-size: 4em; line-height: 1; }
article.post .meta { color: #cabebf; }

footer { position: relative; width: 100%; height: 10em; padding: 3em 10%; background: #fd6366; line-height: 5; text-align: center; z-index: 1000; }
footer a { color: white; }

    </style>

    <script type="text/javascript" src="//use.typekit.net/bcg6ekf.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
</head>


    <body>

        <div class="outer-wrapper">

            <header>
                <h1>
                    <a href="/">Omit</a>
                </h1>
            </header>

            <div class="content">
                <article class="post">

    <h1>Avoiding Gross Javascript with Templates</h1>
    <p class="meta">Oct 27, 2013</p>

    <h2 id="mustache-handlebars-underscore-ejs-hoganhellip">Mustache, Handlebars, Underscore, EJS, Hogan…</h2>

<p>There are a ton of JavaScript templating engines out there right now, but they all do more or less the same thing. They allow you separate your display layer from your application layer. I&rsquo;m sure you&rsquo;ve seen a chunk of jQuery that looks like this&hellip;</p>

<pre title="Yucky jQuery"><code class="language-javascript">
$instagrams.append(
    '&lt;div class="instagram"&gt;' +
        '&lt;div class="user"&gt;' +
            '&lt;img src="' + this.user.profile_picture + '" /&gt;' +
            '&lt;h1&gt;' + this.user.full_name + '&lt;/h1&gt;' +
        '&lt;/div&gt;' +
        '&lt;img src="' + this.images.low_resolution.url + '" /&gt;' +
    '&lt;/div&gt;'
);
</code></pre>

<p>That&rsquo;s code that I wrote. Recently. I&rsquo;m ashamed.</p>

<h2>But this is probably complicated stuff, right?</h2>

<p>Not at all! There are some really pretty, super well structured ways to do JavaScript templating, but if you&rsquo;re not ready to take the deep dive you can get into it very easily right meow.</p>

<p>Here I&rsquo;m going to show you how to take some data from the Instagram API and place it on the page. We&rsquo;re going to be using <a href="http://mustache.github.io/">mustache</a> here, which is a logic-less templating engine. There are much more &ldquo;powerful&rdquo; engines out there, like <a href="http://handlebarsjs.com/">Handlebars</a>, but for our purposes mustache will do very nicely.</p>

<p>There are basically 2 parts to templating: data, and the template itself. We&rsquo;ll start with the data.</p>

<h3>Data</h3>

<p>Mustache &mdash; and every other JS templating engine I&rsquo;ve seen &mdash; just uses a simple JS object. Nothing fancy. This means the JSON that we get back from the Instagram API is mostly good to go. This is what our AJAX call will look like:</p>

<pre title="AJAX"><code class="language-javascript">
var $instagrams       = $('.instagrams'),
    feedPath          = 'https://api.instagram.com/v1/media/popular?client_id=2751b9d3ef1948da8c6eeceefe3fb718&amp;count=3',
    gettingInstagrams = $.ajax({

        url: feedPath,
        dataType: 'jsonp'

    }).done(function(json) {

        var template = $('#instagramSuccess').html(),
            html, data;

        html = Mustache.to_html(template, { photos : json.data });
        $instagrams.append(html);

    });
</code></pre>

<p>So <code>$instagrams</code> is where we&rsquo;ll be appending our photos later, and <code>feedPath</code> is the path for our API query. Then we set up a basic AJAX call.</p>

<p><code>var template = $('#instagramSuccess').html()</code> grabs the code for our HTML template, which you&rsquo;ll see later. Once we&rsquo;ve got the template, we call <code>Mustache.to_html</code>. The first parameter is our template, and the second parameter is our data object. In our case <code>json.data</code> is actually an array, so we have to assign it to an object property. We&rsquo;ll see more how that comes in handy when we talk about the HTML template.</p>

<p>Which is now.</p>

<h3>The Template</h3>

<p>The simplest way to implement a Mustache template is to wrap in a script tag, and place it in your HTML or view file. It would be wise to place all of your templates together at the bottom of your file. This is just basic HTML, with Mustache variables.</p>

<pre title="Mustache Template"><code class="language-markup">

&lt;script id="instagramSuccess" type="text/template"&gt;
  
  &lt;div class="instagram"&gt;
    &lt;div class="user"&gt;
      &lt;img src="" /&gt;
      &lt;h1&gt;&lt;/h1&gt;
    &lt;/div&gt;
    &lt;img src="" /&gt;
  &lt;/div&gt;
  
&lt;/script&gt;

</code></pre>

<p>Two things are required on your template: an ID, and <code>type="text/template"</code>. You <em>could</em> use a class instead of an ID, but since you&rsquo;ll want to make sure this is a completely unique element, you might as well use an ID.</p>

<p>The template starts with <code></code>. You may notice this is the same object property we assigned <code>json.data</code> to earlier. <code></code> tells Mustache that you&rsquo;re trying to loop over an array, and the value (in our case <em>photos</em>) tells Mustache what property stores the array in the data you sent it. If there are 12 array items stored in <code>photos</code> this template will be repeated 12 times.</p>

<p>The rest of the variables match up to the JSON data returned by the Instagram API. The variable name tells it what object property you want, and then when you call <code>Mustache.to_html</code> it replaces that variable with the value of whatever property you&rsquo;re referencing.</p>

<h3>The Result</h3>

<p>The end result should look something like this.</p>

<p data-height="300" data-theme-id="0" data-slug-hash="EvKbH" data-user="frxnz" data-default-tab="result" class="codepen">See the Pen <a href="http://codepen.io/frxnz/pen/EvKbH">JavaScript Templates</a> by Derek Wheelden (<a href="http://codepen.io/frxnz">@frxnz</a>) on <a href="http://codepen.io">CodePen</a></p>

<script async="" src="//codepen.io/assets/embed/ei.js"></script>

<p>You can see it bigger and play around with the code <a href="http://codepen.io/frxnz/pen/AshKo">on CodePen</a>. And if you want to see how the Instagram data relates to the template variables, take a look at the <a href="https://api.instagram.com/v1/media/popular?client_id=2751b9d3ef1948da8c6eeceefe3fb718&amp;count=3">raw JSON</a>.</p>

<h2>Conclusion</h2>

<p>I tend to use JavaScript a lot for integrating API feeds into sites, and I&rsquo;ve always thought that converting HTML to a JS string and dumping it into an append was super gross. JS templating solves that problem by allowing you to write your template in plain old HTML, and use JS to inject actual data values. A good website should do its best to separate display from logic, and templating engines like Mustache make it really easy to do so.</p>


</article>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'dwheelden'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

            </div>

            <footer>
                <a href="http://twitter.com/frxnz">Derek Wheelden</a>
            </footer>

        </div>

        <script src="/js/vendor/prism.js"></script>
        
    </body>
</html>
